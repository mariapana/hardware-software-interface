"use strict";(self.webpackChunkhardware_software_interface=self.webpackChunkhardware_software_interface||[]).push([[318],{5680:(e,n,t)=>{t.d(n,{xA:()=>d,yg:()=>c});var a=t(6540);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},d=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},f="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},g=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),f=p(t),g=r,c=f["".concat(s,".").concat(g)]||f[g]||u[g]||i;return t?a.createElement(c,o(o({ref:n},d),{},{components:t})):a.createElement(c,o({ref:n},d))}));function c(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=g;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[f]="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}g.displayName="MDXCreateElement"},8809:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var a=t(8168),r=(t(6540),t(5680));const i={},o="Reading Data from Standard Input",l={unversionedId:"Lab 11 - Buffer Management. Buffer Overflow/Introduction to Buffers/Drills/Tasks/Read Using gets/README",id:"Lab 11 - Buffer Management. Buffer Overflow/Introduction to Buffers/Drills/Tasks/Read Using gets/README",title:"Reading Data from Standard Input",description:"Access the drills/tasks/read-stdin-gets/support/ directory from the lab resource archive and consult the read_stdin.asm file.",source:"@site/docs/Lab 11 - Buffer Management. Buffer Overflow/Introduction to Buffers/Drills/Tasks/Read Using gets/README.md",sourceDirName:"Lab 11 - Buffer Management. Buffer Overflow/Introduction to Buffers/Drills/Tasks/Read Using gets",slug:"/Lab 11 - Buffer Management. Buffer Overflow/Introduction to Buffers/Drills/Tasks/Read Using gets/",permalink:"/hardware-software-interface/24/Lab 11 - Buffer Management. Buffer Overflow/Introduction to Buffers/Drills/Tasks/Read Using gets/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"Buffer on the Stack",permalink:"/hardware-software-interface/24/Lab 11 - Buffer Management. Buffer Overflow/Introduction to Buffers/Drills/Tasks/Stack Buffer/"},next:{title:"Buffer Overflow with Data from Standard Input and `fgets()`",permalink:"/hardware-software-interface/24/Lab 11 - Buffer Management. Buffer Overflow/Introduction to Buffers/Drills/Tasks/Read Using fgets/"}},s={},p=[{value:"Buffer Overflow with Data from Standard Input",id:"buffer-overflow-with-data-from-standard-input",level:2}],d={toc:p},f="wrapper";function u(e){let{components:n,...t}=e;return(0,r.yg)(f,(0,a.A)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"reading-data-from-standard-input"},"Reading Data from Standard Input"),(0,r.yg)("p",null,"Access the ",(0,r.yg)("inlineCode",{parentName:"p"},"drills/tasks/read-stdin-gets/support/")," directory from the lab resource archive and consult the ",(0,r.yg)("inlineCode",{parentName:"p"},"read_stdin.asm")," file.\nIn this file, there is a program that uses the ",(0,r.yg)("inlineCode",{parentName:"p"},"gets")," call to read information from standard input into a buffer on the stack.\nAs in the previous case, we have allocated a local variable of 4 bytes immediately after the stack buffer."),(0,r.yg)("p",null,"Carefully review the program, then compile it using the command:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-Bash"},"make\n")),(0,r.yg)("p",null,"then run it using the command:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-Bash"},"./read_stdin\n")),(0,r.yg)("p",null,"Observe the behavior of the program depending on the received input."),(0,r.yg)("h2",{id:"buffer-overflow-with-data-from-standard-input"},"Buffer Overflow with Data from Standard Input"),(0,r.yg)("p",null,"The ",(0,r.yg)("a",{parentName:"p",href:"https://man7.org/linux/man-pages/man3/gets.3.html"},"gets")," function is practically prohibited in C programs because of its high vulnerability:\nit does not check the limits of the buffer where the reading is done, and can easily be used for buffer overflow."),(0,r.yg)("p",null,"For this, transmit the corresponding input string so that the displayed value for the local variable is not ",(0,r.yg)("inlineCode",{parentName:"p"},"0xCAFEBABE"),", but ",(0,r.yg)("inlineCode",{parentName:"p"},"0x574F4C46")," (the ASCII hexadecimal values for ",(0,r.yg)("inlineCode",{parentName:"p"},"FLOW"),")."),(0,r.yg)("blockquote",null,(0,r.yg)("p",{parentName:"blockquote"},(0,r.yg)("strong",{parentName:"p"},"IMPORTANT")," Do not modify the assembly language code.\nTransmit the input string in the appropriate format to the standard input to generate a buffer overflow and to obtain the required result.\n",(0,r.yg)("strong",{parentName:"p"},"WARNING")," Do not write the string ",(0,r.yg)("inlineCode",{parentName:"p"},'"574F4C46"'),".\nThis is a string that occupies ",(0,r.yg)("inlineCode",{parentName:"p"},"8")," bytes.\nYou must write the ASCII representation of the number ",(0,r.yg)("inlineCode",{parentName:"p"},"0x574F4C46"),", which is ",(0,r.yg)("inlineCode",{parentName:"p"},"FLOW"),":\n",(0,r.yg)("inlineCode",{parentName:"p"},"0x57")," is ",(0,r.yg)("inlineCode",{parentName:"p"},"W"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"0x4F")," is ",(0,r.yg)("inlineCode",{parentName:"p"},"O"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"0x4C")," is ",(0,r.yg)("inlineCode",{parentName:"p"},"L"),", and ",(0,r.yg)("inlineCode",{parentName:"p"},"0x46")," is ",(0,r.yg)("inlineCode",{parentName:"p"},"F"),".\n",(0,r.yg)("strong",{parentName:"p"},"HINT")," x86 is a ",(0,r.yg)("strong",{parentName:"p"},"little endian")," architecture.\nThat means the string ",(0,r.yg)("inlineCode",{parentName:"p"},'"FLOW"'),", having the character-ASCII code correspondence. If it seems unclear, check out this ",(0,r.yg)("a",{parentName:"p",href:"https://www.geeksforgeeks.org/little-and-big-endian-mystery/"},"link"),"\n",(0,r.yg)("inlineCode",{parentName:"p"},"F"),": ",(0,r.yg)("inlineCode",{parentName:"p"},"0x46"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"L"),": ",(0,r.yg)("inlineCode",{parentName:"p"},"0x4C"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"O"),": ",(0,r.yg)("inlineCode",{parentName:"p"},"0x4F"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"W"),": ",(0,r.yg)("inlineCode",{parentName:"p"},"0x57")," will be stored in memory on ",(0,r.yg)("inlineCode",{parentName:"p"},"4")," bytes as ",(0,r.yg)("inlineCode",{parentName:"p"},"0x574F4C46"),".\nSo at the bigger address we will have ",(0,r.yg)("inlineCode",{parentName:"p"},"W"),", while at the lower address there will be ",(0,r.yg)("inlineCode",{parentName:"p"},"F"),".\n",(0,r.yg)("strong",{parentName:"p"},"HINT")," To transmit the input string, it is recommended to write it in a file and then redirect that file to the corresponding program command.\nYou can use an editor such as ",(0,r.yg)("inlineCode",{parentName:"p"},"gedit")," or ",(0,r.yg)("inlineCode",{parentName:"p"},"vim")," to edit the file.\nThe advantage is that they also display the column you are on, and you can know how many characters you have written in the file.\nAlternatively, you can use python to more easily generate your payload.\nFor example, to generate a payload that overwrites a value in the code with the value ",(0,r.yg)("inlineCode",{parentName:"p"},"0xDEADBEEF"),", you can execute the following command:")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-python"},'python2.7 -c \'print "A" * 32 + "\\xEF\\xBE\\xAD\\xDE"\' > payload\n')),(0,r.yg)("blockquote",null,(0,r.yg)("p",{parentName:"blockquote"},(0,r.yg)("strong",{parentName:"p"},"NOTE")," number ",(0,r.yg)("inlineCode",{parentName:"p"},"32")," is only an example and it represents the size of buffer that needs to be bypassed.\nIt is recommended to name the file ",(0,r.yg)("inlineCode",{parentName:"p"},"payload"),". Redirecting the ",(0,r.yg)("inlineCode",{parentName:"p"},"payload")," file to the program is done using a command like:")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-Bash"},"./read_stdin < payload\n")),(0,r.yg)("p",null,"If done correctly, you will see:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-Bash"},"var is 0x574F4C46\n")),(0,r.yg)("p",null,"If you're having difficulties solving this exercise, go through ",(0,r.yg)("a",{parentName:"p",href:"/hardware-software-interface/24/Lab%2011%20-%20Buffer%20Management.%20Buffer%20Overflow/Introduction%20to%20Buffers/Reading/#How-to-make-a-Buffer-Overflow?"},"this")," reading material."))}u.isMDXComponent=!0}}]);